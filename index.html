<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Collections Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .title-font {
            font-family: 'Pacifico', cursive;
        }
        .modal {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal.hidden {
            opacity: 0;
            visibility: hidden;
        }
        .payment-option-label {
            transition: background-color 0.2s, border-color 0.2s;
        }
        input[name="onlinePaymentOption"]:checked + label {
            background-color: #e0f2fe;
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">

    <!-- Dashboard Container -->
    <div class="max-w-7xl mx-auto">
        <header class="bg-white p-6 rounded-2xl shadow-lg mb-8 flex items-center justify-between">
            <div>
                <h1 class="title-font text-4xl sm:text-5xl font-bold text-center text-green-600">Foodie.com</h1>
                <p class="text-center text-gray-500 mt-2">Explore a world of flavors and culinary delights.</p>
            </div>
            
            <!-- Header Actions -->
            <div class="flex items-center gap-4">
                <!-- Cart Icon and Count -->
                <div id="cartIcon" class="relative cursor-pointer">
                    <!-- SVG Cart Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-600 hover:text-green-600 transition-colors duration-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 12.33a2 2 0 0 0 1.95 1.67h8.84a2 2 0 0 0 1.95-1.67L23 6H6"></path>
                    </svg>
                    <!-- Cart Item Count Badge -->
                    <span id="cartCount" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 transform translate-x-1/2 -translate-y-1/2 rounded-full">0</span>
                </div>
            </div>
        </header>

        <!-- Filter and Search Section -->
        <div class="flex flex-col sm:flex-row gap-4 mb-8">
            <input type="text" id="searchInput" placeholder="Search for a food item..."
                   class="flex-grow p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition duration-300 ease-in-out">
            <select id="categoryFilter"
                    class="p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-sm transition duration-300 ease-in-out sm:w-1/4">
                <option value="all">All Categories</option>
                <option value="main">Main Dishes</option>
                <option value="dessert">Desserts</option>
                <option value="drink">Drinks</option>
                <option value="appetizer">Appetizers</option>
            </select>
        </div>

        <!-- Food Cards Grid -->
        <div id="foodContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Food cards will be injected here by JavaScript -->
        </div>

        <!-- Item added notification -->
        <div id="notification" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 px-6 py-3 bg-green-500 text-white rounded-xl shadow-lg transition-opacity duration-300 opacity-0 pointer-events-none z-50">
            Item added to cart!
        </div>

    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center p-4 hidden z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl transform scale-95 transition-all duration-300 ease-in-out">
            <div class="flex justify-between items-center mb-4 pb-2 border-b-2">
                <h2 class="text-2xl font-bold">Your Cart</h2>
                <button id="closeCartModal" class="text-gray-500 hover:text-gray-900 text-2xl font-bold transition-colors duration-300">&times;</button>
            </div>
            <div id="cartItems" class="max-h-96 overflow-y-auto mb-4">
                <!-- Cart items will be injected here -->
            </div>
            <div class="flex justify-between items-center pt-4 border-t-2">
                <span class="text-xl font-bold">Total: <span id="cartTotal">₹0</span></span>
                <button id="placeOrderBtn" class="bg-green-600 text-white px-6 py-3 rounded-xl font-semibold shadow-md hover:bg-green-700 transition-colors duration-300">Place Order</button>
            </div>
        </div>
    </div>

    <!-- Details and Payment Modal -->
    <div id="detailsModal" class="modal fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center p-4 hidden z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-lg transform scale-95 transition-all duration-300 ease-in-out">
            <div class="flex justify-between items-center mb-4 pb-2 border-b-2">
                <h2 class="text-2xl font-bold">Customer Details & Payment</h2>
                <button id="closeDetailsModal" class="text-gray-500 hover:text-gray-900 text-2xl font-bold transition-colors duration-300">&times;</button>
            </div>
            <form id="orderForm" class="space-y-4">
                <div>
                    <label for="customerName" class="block text-sm font-medium text-gray-700">Name</label>
                    <input type="text" id="customerName" name="customerName" required
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2">
                </div>
                <div>
                    <label for="phoneNumber" class="block text-sm font-medium text-gray-700">Phone Number (India)</label>
                    <input type="tel" id="phoneNumber" name="phoneNumber" required pattern="[0-9]{10}"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2">
                </div>
                <div>
                    <label for="customerAddress" class="block text-sm font-medium text-gray-700">Address</label>
                    <textarea id="customerAddress" name="customerAddress" rows="3" required
                              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Payment Option</label>
                    <div class="mt-2 space-y-2">
                        <div class="flex items-center">
                            <input id="cod" name="paymentOption" type="radio" checked class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300">
                            <label for="cod" class="ml-3 block text-sm font-medium text-gray-700">Cash on Delivery</label>
                        </div>
                        <div class="flex items-center">
                            <input id="onlinePayment" name="paymentOption" type="radio" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300">
                            <label for="onlinePayment" class="ml-3 block text-sm font-medium text-gray-700">Online Payment</label>
                        </div>
                    </div>
                </div>
                
                <!-- Online Payment Options (Hidden by default) -->
                <div id="onlinePaymentOptions" class="space-y-4 hidden">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Choose Online Payment Method</label>
                        <div class="mt-2 grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div>
                                <input type="radio" name="onlinePaymentOption" id="upi" value="UPI" class="hidden peer">
                                <label for="upi" class="payment-option-label flex items-center justify-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer text-center font-medium hover:bg-gray-50 peer-checked:bg-blue-50 peer-checked:border-blue-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 12h.01M16 12h.01M12 6h.01M6 12a6 6 0 1112 0 6 6 0 01-12 0z" />
                                    </svg>
                                    UPI
                                </label>
                            </div>
                            <div>
                                <input type="radio" name="onlinePaymentOption" id="creditCard" value="Credit Card" class="hidden peer">
                                <label for="creditCard" class="payment-option-label flex items-center justify-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer text-center font-medium hover:bg-gray-50 peer-checked:bg-blue-50 peer-checked:border-blue-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                                    </svg>
                                    Credit Card
                                </label>
                            </div>
                            <div>
                                <input type="radio" name="onlinePaymentOption" id="netBanking" value="Net Banking" class="hidden peer">
                                <label for="netBanking" class="payment-option-label flex items-center justify-center p-4 border-2 border-gray-300 rounded-xl cursor-pointer text-center font-medium hover:bg-gray-50 peer-checked:bg-blue-50 peer-checked:border-blue-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9v2m0 0v2m0-2h2m-2 0h-2m2 0a2 2 0 11-4 0 2 2 0 014 0zM12 21a9 9 0 100-18 9 9 0 000 18z" />
                                    </svg>
                                    Net Banking
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <div class="mt-6 text-right">
                <button id="confirmOrderBtn" class="bg-green-600 text-white px-6 py-3 rounded-xl font-semibold shadow-md hover:bg-green-700 transition-colors duration-300 w-full">Confirm Order</button>
            </div>
        </div>
    </div>
    
    <!-- Processing Order Modal -->
    <div id="processingModal" class="modal fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center p-4 hidden z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm transform scale-95 transition-all duration-300 ease-in-out text-center">
            <div class="flex justify-center mb-4">
                <svg class="animate-spin h-12 w-12 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </div>
            <h2 class="text-2xl font-bold mb-2">Processing Your Order...</h2>
            <p class="text-gray-600">Please wait while we finalize your order details.</p>
        </div>
    </div>

    <!-- Order Confirmation Receipt Modal -->
    <div id="receiptModal" class="modal fixed inset-0 bg-gray-900 bg-opacity-50 flex justify-center items-center p-4 hidden z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl transform scale-95 transition-all duration-300 ease-in-out">
            <div class="flex justify-between items-center mb-4 pb-2 border-b-2">
                <h2 class="text-2xl font-bold text-green-600">Invoice</h2>
                <button id="closeReceiptModal" class="text-gray-500 hover:text-gray-900 text-2xl font-bold transition-colors duration-300">&times;</button>
            </div>
            <p class="text-gray-700 mb-4">Thank you for your order. We've received your request and your food will be delivered shortly.</p>
            
            <div class="space-y-4 mb-6">
                <div>
                    <p class="text-sm font-bold text-gray-800">Customer Details:</p>
                    <p class="text-gray-600"><span class="font-semibold">Name:</span> <span id="receiptCustomerName"></span></p>
                    <p class="text-gray-600"><span class="font-semibold">Phone:</span> <span id="receiptCustomerPhone"></span></p>
                    <p class="text-gray-600"><span class="font-semibold">Address:</span> <span id="receiptCustomerAddress"></span></p>
                </div>
                <div>
                    <p class="text-sm font-bold text-gray-800">Order Summary:</p>
                    <div id="receiptItemsContainer" class="mt-2 space-y-1">
                        <!-- Order items will be injected here -->
                    </div>
                </div>
            </div>
            
            <div class="flex justify-between items-center pt-4 border-t-2">
                <span class="text-xl font-bold">Total: <span id="receiptTotal">₹0</span></span>
                <button class="bg-blue-600 text-white px-4 py-2 rounded-xl text-sm font-semibold shadow-md hover:bg-blue-700 transition-colors duration-300">Download Invoice</button>
            </div>
        </div>
    </div>

    <!-- JavaScript for Dashboard Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const foodCollections = [
                {
                    name: "Classic Margherita Pizza",
                    description: "A simple yet delicious pizza topped with fresh tomatoes, mozzarella, and basil.",
                    category: "main",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Pizza",
                    tags: ["Italian", "cheese", "vegetarian"],
                    rate: 450,
                    discount_percentage: 20
                },
                {
                    name: "Decadent Chocolate Cake",
                    description: "A rich, moist chocolate cake with a velvety chocolate ganache frosting.",
                    category: "dessert",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Cake",
                    tags: ["chocolate", "sweet", "baked"],
                    rate: 320,
                    discount_percentage: null
                },
                {
                    name: "Spicy Chicken Tacos",
                    description: "Tender chicken marinated in spices, served in soft tortillas with fresh salsa.",
                    category: "main",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Tacos",
                    tags: ["Mexican", "spicy", "chicken"],
                    rate: 280,
                    discount_percentage: 10
                },
                {
                    name: "Fresh Strawberry Smoothie",
                    description: "A refreshing blend of strawberries, banana, and yogurt, perfect for a quick snack.",
                    category: "drink",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Smoothie",
                    tags: ["fruit", "healthy", "blended"],
                    rate: 180,
                    discount_percentage: null
                },
                {
                    name: "Crispy Spring Rolls",
                    description: "Fried rolls filled with vegetables, served with a sweet and sour dipping sauce.",
                    category: "appetizer",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Spring+Rolls",
                    tags: ["Asian", "fried", "snack"],
                    rate: 210,
                    discount_percentage: null
                },
                {
                    name: "Grilled Salmon with Asparagus",
                    description: "A healthy and flavorful dish of grilled salmon seasoned with lemon and herbs.",
                    category: "main",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Salmon",
                    tags: ["seafood", "healthy", "dinner"],
                    rate: 750,
                    discount_percentage: 15
                },
                {
                    name: "Fruit Salad with Mint",
                    description: "A refreshing mix of seasonal fruits, including berries, melon, and citrus.",
                    category: "dessert",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Fruit+Salad",
                    tags: ["fruit", "healthy", "light"],
                    rate: 150,
                    discount_percentage: null
                },
                {
                    name: "Iced Caramel Macchiato",
                    description: "A popular coffee drink with a shot of espresso, milk, and sweet caramel drizzle.",
                    category: "drink",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Coffee",
                    tags: ["coffee", "iced", "sweet"],
                    rate: 220,
                    discount_percentage: 5
                },
                {
                    name: "Cheese and Charcuterie Board",
                    description: "An elegant platter with a variety of cheeses, cured meats, and crackers.",
                    category: "appetizer",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Cheese+Board",
                    tags: ["platter", "snack", "party"],
                    rate: 680,
                    discount_percentage: null
                },
                {
                    name: "Beef and Broccoli Stir-Fry",
                    description: "Tender slices of beef and crisp broccoli tossed in a savory ginger sauce.",
                    category: "main",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Stir-Fry",
                    tags: ["Chinese", "beef", "vegetables"],
                    rate: 550,
                    discount_percentage: null
                },
                {
                    name: "Mango Lassi",
                    description: "A traditional Indian yogurt-based drink with fresh mango puree.",
                    category: "drink",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Mango+Lassi",
                    tags: ["Indian", "yogurt", "fruit"],
                    rate: 175,
                    discount_percentage: null
                },
                {
                    name: "Paneer Tikka Masala",
                    description: "Cubes of cottage cheese cooked in a rich, creamy tomato gravy.",
                    category: "main",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Paneer+Tikka",
                    tags: ["Indian", "vegetarian", "curry"],
                    rate: 420,
                    discount_percentage: 25
                },
                {
                    name: "Gulab Jamun",
                    description: "Soft, spongy milk-based dumplings soaked in a sugar syrup.",
                    category: "dessert",
                    image_url: "https://placehold.co/600x400/525252/FFF?text=Gulab+Jamun",
                    tags: ["Indian", "sweet", "dessert"],
                    rate: 190,
                    discount_percentage: null
                }
            ];

            const foodContainer = document.getElementById('foodContainer');
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            const cartCountElement = document.getElementById('cartCount');
            const notificationElement = document.getElementById('notification');
            const cartIcon = document.getElementById('cartIcon');
            const cartModal = document.getElementById('cartModal');
            const closeCartModalBtn = document.getElementById('closeCartModal');
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotalElement = document.getElementById('cartTotal');
            const placeOrderBtn = document.getElementById('placeOrderBtn');
            const detailsModal = document.getElementById('detailsModal');
            const closeDetailsModalBtn = document.getElementById('closeDetailsModal');
            const orderForm = document.getElementById('orderForm');
            const confirmOrderBtn = document.getElementById('confirmOrderBtn');
            const onlinePaymentRadio = document.getElementById('onlinePayment');
            const onlinePaymentOptions = document.getElementById('onlinePaymentOptions');
            
            const processingModal = document.getElementById('processingModal');
            const receiptModal = document.getElementById('receiptModal');
            const closeReceiptModalBtn = document.getElementById('closeReceiptModal');
            const receiptCustomerName = document.getElementById('receiptCustomerName');
            const receiptCustomerPhone = document.getElementById('receiptCustomerPhone');
            const receiptCustomerAddress = document.getElementById('receiptCustomerAddress');
            const receiptItemsContainer = document.getElementById('receiptItemsContainer');
            const receiptTotal = document.getElementById('receiptTotal');

            let cart = [];

            /**
             * Updates the cart count displayed in the header badge.
             */
            const updateCartCount = () => {
                cartCountElement.textContent = cart.length;
            };

            /**
             * Adds a food item to the cart and shows a notification.
             * @param {string} foodName - The name of the food item to add.
             */
            window.addToCart = (foodName) => {
                const foodItem = foodCollections.find(food => food.name === foodName);
                if (foodItem) {
                    const priceToAdd = foodItem.discount_percentage
                        ? foodItem.rate - (foodItem.rate * foodItem.discount_percentage / 100)
                        : foodItem.rate;

                    const cartItem = {
                        name: foodItem.name,
                        price: priceToAdd
                    };
                    
                    cart.push(cartItem);
                    updateCartCount();

                    // Show a temporary notification
                    notificationElement.textContent = 'Item added to cart!';
                    notificationElement.classList.remove('opacity-0', 'pointer-events-none', 'bg-red-500');
                    notificationElement.classList.add('opacity-100', 'bg-green-500');
                    setTimeout(() => {
                        notificationElement.classList.add('opacity-0', 'pointer-events-none');
                        notificationElement.classList.remove('opacity-100');
                    }, 1500);
                }
            };

            /**
             * Renders the items in the cart modal.
             */
            const renderCart = () => {
                cartItemsContainer.innerHTML = '';
                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '<p class="text-center text-gray-500 py-4">Your cart is empty.</p>';
                }

                let total = 0;
                cart.forEach(item => {
                    total += item.price;
                    const cartItemHtml = `
                        <div class="flex items-center justify-between py-2 border-b last:border-b-0">
                            <span class="text-gray-800">${item.name}</span>
                            <span class="font-semibold text-green-600">₹${item.price.toFixed(2)}</span>
                        </div>
                    `;
                    cartItemsContainer.insertAdjacentHTML('beforeend', cartItemHtml);
                });
                cartTotalElement.textContent = `₹${total.toFixed(2)}`;
            };

            /**
             * Shows the cart modal.
             */
            const openCartModal = () => {
                renderCart();
                cartModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Prevents scrolling
            };

            /**
             * Hides the cart modal.
             */
            const closeCartModal = () => {
                cartModal.classList.add('hidden');
                document.body.style.overflow = 'auto'; // Re-enables scrolling
            };

            /**
             * Shows the details and payment modal.
             */
            const openDetailsModal = () => {
                if (cart.length === 0) {
                    return;
                }
                closeCartModal();
                detailsModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            };

            /**
             * Hides the details and payment modal.
             */
            const closeDetailsModal = () => {
                detailsModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            };

            /**
             * Opens the order confirmation receipt modal.
             * @param {Object} orderData - The data for the confirmed order.
             */
            const openReceiptModal = (orderData) => {
                receiptCustomerName.textContent = orderData.name;
                receiptCustomerPhone.textContent = orderData.phone;
                receiptCustomerAddress.textContent = orderData.address;
                receiptTotal.textContent = `₹${orderData.total.toFixed(2)}`;
                
                receiptItemsContainer.innerHTML = '';
                orderData.items.forEach(item => {
                    const itemHtml = `
                        <div class="flex justify-between items-center text-gray-600">
                            <span>${item.name}</span>
                            <span>₹${item.price.toFixed(2)}</span>
                        </div>
                    `;
                    receiptItemsContainer.insertAdjacentHTML('beforeend', itemHtml);
                });

                receiptModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            };
            
            /**
             * Closes the order confirmation receipt modal.
             */
            const closeReceiptModal = () => {
                receiptModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            };

            /**
             * Shows the processing modal.
             */
            const openProcessingModal = () => {
                processingModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            };

            /**
             * Hides the processing modal.
             */
            const closeProcessingModal = () => {
                processingModal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            };
            
            /**
             * Validates form details, processes the order, and shows a confirmation message.
             */
            const confirmOrder = (event) => {
                event.preventDefault();
                
                const name = document.getElementById('customerName').value;
                const phone = document.getElementById('phoneNumber').value;
                const address = document.getElementById('customerAddress').value;

                if (!name || !phone || !address || phone.length !== 10) {
                    // Show error message on the notification bar.
                    notificationElement.textContent = 'Please fill out all the details correctly (Phone number must be 10 digits).';
                    notificationElement.classList.remove('opacity-0', 'pointer-events-none', 'bg-green-500');
                    notificationElement.classList.add('opacity-100', 'bg-red-500');
                    setTimeout(() => {
                        notificationElement.classList.add('opacity-0', 'pointer-events-none');
                        notificationElement.classList.remove('opacity-100', 'bg-red-500');
                        notificationElement.textContent = 'Item added to cart!';
                        notificationElement.classList.add('bg-green-500');
                    }, 3000);
                    return;
                }

                const paymentOption = document.querySelector('input[name="paymentOption"]:checked').id;

                if (paymentOption === 'onlinePayment') {
                    const onlinePaymentMethod = document.querySelector('input[name="onlinePaymentOption"]:checked');
                    if (!onlinePaymentMethod) {
                        // Show error message on the notification bar.
                        notificationElement.textContent = 'Please select an online payment method.';
                        notificationElement.classList.remove('opacity-0', 'pointer-events-none', 'bg-green-500');
                        notificationElement.classList.add('opacity-100', 'bg-red-500');
                        setTimeout(() => {
                            notificationElement.classList.add('opacity-0', 'pointer-events-none');
                            notificationElement.classList.remove('opacity-100', 'bg-red-500');
                            notificationElement.textContent = 'Item added to cart!';
                            notificationElement.classList.add('bg-green-500');
                        }, 3000);
                        return;
                    }
                }
                
                // Get order details before clearing the cart
                const orderData = {
                    name,
                    phone,
                    address,
                    items: [...cart],
                    total: cart.reduce((sum, item) => sum + item.price, 0)
                };

                // Clear the form and close the details modal
                orderForm.reset();
                closeDetailsModal();
                
                // Simulate backend processing
                openProcessingModal();
                setTimeout(() => {
                    closeProcessingModal();
                    openReceiptModal(orderData);
                    // Clear the cart and update the count
                    cart = [];
                    updateCartCount();
                }, 2000); // Simulate 2 seconds of network delay

            };
            
            /**
             * Renders a list of food items as cards in the dashboard.
             * @param {Array} foodsToRender - The array of food objects to display.
             */
            const renderFoods = (foodsToRender) => {
                foodContainer.innerHTML = ''; // Clear previous content
                if (foodsToRender.length === 0) {
                    foodContainer.innerHTML = '<p class="col-span-full text-center text-gray-500 text-lg py-12">No food items found matching your criteria.</p>';
                    return;
                }
                foodsToRender.forEach(food => {
                    const finalRate = food.discount_percentage
                        ? (food.rate - (food.rate * food.discount_percentage / 100)).toFixed(2)
                        : food.rate.toFixed(2);
                        
                    const priceHtml = food.discount_percentage
                        ? `<div class="flex items-center gap-2">
                             <span class="text-xl font-bold text-green-600">₹${finalRate}</span>
                             <span class="text-sm text-gray-400 line-through">₹${food.rate}</span>
                           </div>`
                        : `<span class="text-xl font-bold text-green-600">₹${finalRate}</span>`;

                    const foodCard = `
                        <div class="bg-white rounded-xl shadow-md overflow-hidden transform hover:scale-105 transition-all duration-300 ease-in-out border border-gray-200 cursor-pointer relative" onclick="addToCart('${food.name.replace(/'/g, "\\'")}')">
                            <img src="${food.image_url}" alt="${food.name}" class="w-full h-48 object-cover">
                            ${food.discount_percentage ? `<div class="absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">-${food.discount_percentage}% OFF</div>` : ''}
                            <div class="p-6">
                                <h3 class="font-bold text-xl text-gray-900 truncate">${food.name}</h3>
                                <p class="text-gray-600 text-sm mt-2 line-clamp-3">${food.description}</p>
                                <div class="mt-4 flex flex-wrap gap-2">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${food.category.toUpperCase()}</span>
                                    ${food.tags.map(tag => `<span class="bg-gray-200 text-gray-700 text-xs font-medium px-2.5 py-0.5 rounded-full">${tag}</span>`).join('')}
                                </div>
                                <div class="mt-4 text-right">
                                    ${priceHtml}
                                </div>
                            </div>
                        </div>
                    `;
                    foodContainer.insertAdjacentHTML('beforeend', foodCard);
                });
            };

            const filterAndSearch = () => {
                const query = searchInput.value.toLowerCase();
                const category = categoryFilter.value;

                const filteredFoods = foodCollections.filter(food => {
                    const matchesSearch = food.name.toLowerCase().includes(query) ||
                                          food.description.toLowerCase().includes(query) ||
                                          food.tags.some(tag => tag.toLowerCase().includes(query));
                    const matchesCategory = category === 'all' || food.category === category;
                    return matchesSearch && matchesCategory;
                });

                renderFoods(filteredFoods);
            };

            // Event listeners
            searchInput.addEventListener('input', filterAndSearch);
            categoryFilter.addEventListener('change', filterAndSearch);
            cartIcon.addEventListener('click', openCartModal);
            closeCartModalBtn.addEventListener('click', closeCartModal);
            placeOrderBtn.addEventListener('click', openDetailsModal);
            closeDetailsModalBtn.addEventListener('click', closeDetailsModal);
            orderForm.addEventListener('submit', confirmOrder);
            closeReceiptModalBtn.addEventListener('click', closeReceiptModal);
            
            // Toggle online payment options visibility
            document.querySelectorAll('input[name="paymentOption"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    if (e.target.id === 'onlinePayment') {
                        onlinePaymentOptions.classList.remove('hidden');
                    } else {
                        onlinePaymentOptions.classList.add('hidden');
                    }
                });
            });

            // Close modals when clicking outside of them
            cartModal.addEventListener('click', (e) => {
                if (e.target.id === 'cartModal') {
                    closeCartModal();
                }
            });

            detailsModal.addEventListener('click', (e) => {
                if (e.target.id === 'detailsModal') {
                    closeDetailsModal();
                }
            });
            
            receiptModal.addEventListener('click', (e) => {
                if (e.target.id === 'receiptModal') {
                    closeReceiptModal();
                }
            });

            // Initial render
            renderFoods(foodCollections);
        });
    </script>
</body>
</html>
